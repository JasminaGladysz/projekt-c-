#include <fmx.h>
#include <fmx.Controls.hpp>
#include <FMX.DialogService.Async.hpp>
#include <fmx.Forms.hpp>
#include <fmx.Dialogs.hpp>
#include <fmx.Graphics.hpp>
#pragma hdrstop

#include "MenuForm_.h"
#include "ImageForm_.h"
#include "GalleryForm_.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.fmx"
TMenuForm *MenuForm;
//---------------------------------------------------------------------------

__fastcall TMenuForm::TMenuForm(TComponent* Owner)
	: TForm(Owner)
{
    // Tworzenie ImageForm
    ImageForm = new TImageForm(Application);

    TImage *add_button = new TImage(this);
    add_button->Parent = this;
    add_button->Position->X = 50; // Ustawienie pozycji X
    add_button->Position->Y = 100; // Ustawienie pozycji Y
    add_button->Width = 150; // Ustawienie szerokoœci
    add_button->Height = 50; // Ustawienie wysokoœci
    add_button->Bitmap->LoadFromFile("C:\\Users\\Jasmina\\Documents\\Embarcadero\\Studio\\pic\\add_button.png");
    add_button->OnClick = add_buttonClick;

    TImage *gallery_button = new TImage(this);
    gallery_button->Parent = this;
    gallery_button->Position->X = 50; // Ustawienie pozycji X
    gallery_button->Position->Y = 200; // Ustawienie pozycji Y
    gallery_button->Width = 150; // Ustawienie szerokoœci
    gallery_button->Height = 50; // Ustawienie wysokoœci
    gallery_button->Bitmap->LoadFromFile("C:\\Users\\Jasmina\\Documents\\Embarcadero\\Studio\\pic\\gallery_button.png");
    gallery_button->OnClick = gallery_buttonClick;
}
//---------------------------------------------------------------------------

void __fastcall TMenuForm::add_buttonClick(TObject *Sender)
{
    TDialogServiceAsync::OpenFileDialog(
        [this](const TFileName AFileName) { // Funkcja callback po wybraniu pliku
            if (!AFileName.IsEmpty()) {     // SprawdŸ, czy plik zosta³ wybrany
                try {
                    // Za³aduj obraz do ImageForm
                    ImageForm->Image->Bitmap->LoadFromFile(AFileName);

                    // Poka¿ ImageForm z za³adowanym obrazem
                    this->Hide();
                    ImageForm->ShowModal();
                    this->Show();
                } catch (...) {
                    // Obs³uga b³êdów, np. jeœli obraz nie móg³ zostaæ za³adowany
                    ShowMessage("Nie uda³o siê za³adowaæ obrazu.");
                }
            }
        },
        // Filtr plików obs³ugiwanych przez dialog
        {"*.jpg;*.jpeg;*.bmp;*.png", "Obrazy (*.jpg;*.jpeg;*.bmp;*.png)"}
    );
}

//---------------------------------------------------------------------------

void __fastcall TMenuForm::gallery_buttonClick(TObject *Sender)
{
    MenuForm->Hide();
    GalleryForm->Show();
}
//---------------------------------------------------------------------------

